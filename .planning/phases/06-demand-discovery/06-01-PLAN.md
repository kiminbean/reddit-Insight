---
phase: 06-demand-discovery
plan: 01
type: execute
depends_on: ["05-02"]
files_modified: [src/reddit_insight/analysis/demand_patterns.py]
---

<objective>
수요 표현 패턴을 정의한다.

Purpose: "이거 있으면 좋겠다" 류의 미충족 수요를 탐지하기 위한 패턴 정의
Output: DemandPattern, DemandPatternLibrary, 영어/한국어 패턴셋
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/reddit_insight/analysis/keywords.py

**Prior phase context:**
- UnifiedKeywordExtractor, YAKEExtractor 구현됨
- RedditTokenizer로 텍스트 전처리 가능
- Post, Comment 모델 정의됨

**Demand expression patterns (English):**
- "I wish there was..."
- "Why isn't there a..."
- "Looking for something that..."
- "Does anyone know of..."
- "Is there anything that..."
- "I'd pay for..."
- "Would love to see..."
- "Need a solution for..."
- "Frustrated with..."
- "Can't find a good..."

**Demand expression patterns (Korean):**
- "~이/가 있었으면 좋겠다"
- "~하는 거 없나요?"
- "~찾고 있는데"
- "~할 수 있는 방법"
- "~해결책 없을까요"
</context>

<tasks>

<task type="auto">
  <name>Task 1: 수요 패턴 데이터 구조</name>
  <files>src/reddit_insight/analysis/demand_patterns.py</files>
  <action>
  src/reddit_insight/analysis/demand_patterns.py 생성:

  1. DemandCategory 열거형:
     - FEATURE_REQUEST: 기능 요청 ("I wish there was...")
     - PAIN_POINT: 불만/문제점 ("Frustrated with...")
     - SEARCH_QUERY: 검색/탐색 ("Looking for...", "Does anyone know...")
     - WILLINGNESS_TO_PAY: 구매 의향 ("I'd pay for...")
     - ALTERNATIVE_SEEKING: 대안 탐색 ("Is there anything like...")

  2. DemandPattern 데이터 클래스:
     - pattern_id: str
     - category: DemandCategory
     - regex_pattern: str (정규식)
     - keywords: list[str] (트리거 키워드)
     - language: str = "en"
     - weight: float = 1.0 (중요도 가중치)
     - examples: list[str] = []

  3. DemandMatch 데이터 클래스:
     - pattern: DemandPattern
     - text: str (원본 텍스트)
     - matched_span: tuple[int, int]
     - context: str (매칭 주변 텍스트)
     - confidence: float (0-1)
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.analysis.demand_patterns import DemandCategory, DemandPattern, DemandMatch; print('DemandPattern OK')"
  </verify>
  <done>
  - 수요 패턴 데이터 구조 정의됨
  - 5가지 수요 카테고리 정의
  </done>
</task>

<task type="auto">
  <name>Task 2: 영어 패턴 라이브러리</name>
  <files>src/reddit_insight/analysis/demand_patterns.py</files>
  <action>
  demand_patterns.py에 영어 패턴 추가:

  1. ENGLISH_PATTERNS 리스트 생성:

  **FEATURE_REQUEST 패턴:**
  - r"i wish (?:there was|someone would|we had)"
  - r"would (?:love|be great|be nice) (?:to see|if)"
  - r"(?:we|i) need (?:a|an|something)"

  **PAIN_POINT 패턴:**
  - r"(?:so )?frustrated (?:with|by|that)"
  - r"(?:really )?annoying (?:that|when|how)"
  - r"(?:hate|can't stand) (?:how|when|that)"
  - r"why (?:is|does|can't) (?:it|this)"

  **SEARCH_QUERY 패턴:**
  - r"(?:looking|searching) for (?:a|an|something)"
  - r"does anyone know (?:of|about|if)"
  - r"is there (?:a|an|any)"
  - r"can anyone recommend"
  - r"(?:any )?suggestions? for"

  **WILLINGNESS_TO_PAY 패턴:**
  - r"(?:i'd|i would|would) pay (?:\$?\d+|money|for)"
  - r"(?:willing|happy) to pay"
  - r"(?:take|shut up and take) my money"

  **ALTERNATIVE_SEEKING 패턴:**
  - r"(?:alternative|replacement) (?:to|for)"
  - r"(?:something|anything) (?:like|similar)"
  - r"(?:better|cheaper|free) (?:alternative|option)"

  2. 각 패턴에 예시 문장 포함
  3. weight 조정 (구매 의향 > 기능 요청 > 불만)
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.analysis.demand_patterns import ENGLISH_PATTERNS; print(f'English patterns: {len(ENGLISH_PATTERNS)}')"
  </verify>
  <done>
  - 영어 수요 표현 패턴 15개+ 정의
  - 카테고리별 분류 완료
  </done>
</task>

<task type="auto">
  <name>Task 3: 패턴 라이브러리 클래스</name>
  <files>src/reddit_insight/analysis/demand_patterns.py</files>
  <action>
  demand_patterns.py에 DemandPatternLibrary 클래스 추가:

  1. DemandPatternLibrary 클래스:
     - __init__(language: str = "en")
     - _patterns: list[DemandPattern]
     - _compiled: dict[str, re.Pattern] (컴파일된 정규식)

  2. 패턴 관리 메서드:
     - add_pattern(pattern: DemandPattern)
     - get_patterns(category: DemandCategory | None = None) -> list[DemandPattern]
     - get_pattern_by_id(pattern_id: str) -> DemandPattern | None

  3. 초기화 메서드:
     - load_default_patterns(language: str = "en"):
       - 언어별 기본 패턴 로드
     - _compile_patterns():
       - 정규식 사전 컴파일

  4. 팩토리 메서드:
     - @classmethod create_english_library() -> DemandPatternLibrary
     - @classmethod create_korean_library() -> DemandPatternLibrary
     - @classmethod create_multilingual_library() -> DemandPatternLibrary
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.analysis.demand_patterns import DemandPatternLibrary; lib = DemandPatternLibrary.create_english_library(); print(f'Library patterns: {len(lib._patterns)}')"
  </verify>
  <done>
  - DemandPatternLibrary로 패턴 관리
  - 언어별 팩토리 메서드 제공
  </done>
</task>

<task type="auto">
  <name>Task 4: export 및 검증</name>
  <files>src/reddit_insight/analysis/__init__.py</files>
  <action>
  1. __init__.py 업데이트:
     - DemandCategory, DemandPattern, DemandMatch export
     - DemandPatternLibrary export
     - ENGLISH_PATTERNS export
     - __all__ 업데이트

  2. 패턴 검증 테스트:
     - 기본 패턴이 예시 문장과 매칭되는지 확인
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.analysis import DemandPatternLibrary, DemandCategory; lib = DemandPatternLibrary.create_english_library(); print('All demand pattern exports OK')"
  </verify>
  <done>
  - 수요 패턴 모듈 export됨
  - 기본 패턴 검증 완료
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] DemandCategory 5가지 정의됨
- [ ] DemandPattern, DemandMatch 데이터 구조 있음
- [ ] 영어 패턴 15개+ 정의됨
- [ ] DemandPatternLibrary 팩토리 메서드 동작
</verification>

<success_criteria>

- 모든 태스크 완료
- 수요 표현 패턴 라이브러리 구축
- 카테고리별 패턴 분류 완료

</success_criteria>

<output>
After completion, create `.planning/phases/06-demand-discovery/06-01-SUMMARY.md`
</output>
