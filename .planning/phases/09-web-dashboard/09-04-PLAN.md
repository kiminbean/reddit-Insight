---
phase: 09-web-dashboard
plan: 04
type: execute
depends_on: ["09-01", "09-02", "09-03"]
files_modified: [src/reddit_insight/dashboard/routers/insights.py, src/reddit_insight/dashboard/templates/insights/]
---

<objective>
비즈니스 인사이트 뷰를 구현한다.

Purpose: 인사이트 및 추천을 시각화하는 핵심 대시보드 뷰
Output: Insights 페이지, 추천 카드, 실행 가능성 뷰
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-web-dashboard/09-01-PLAN.md

**Prior plan context:**
- FastAPI 앱 설정됨
- TrendService, DemandService, CompetitionService 패턴

**Data sources:**
- RulesEngine: 인사이트 생성
- OpportunityScorer: 비즈니스 스코어
- FeasibilityAnalyzer: 실행 가능성
</context>

<tasks>

<task type="auto">
  <name>Task 1: 인사이트 라우터</name>
  <files>src/reddit_insight/dashboard/routers/insights.py</files>
  <action>
  routers/insights.py 생성:

  1. router = APIRouter(prefix="/insights", tags=["insights"])

  2. 라우트:
     - GET /insights/: 인사이트 메인 페이지
     - GET /insights/list: 인사이트 목록 (HTMX partial)
     - GET /insights/{insight_id}: 인사이트 상세
     - GET /insights/recommendations: 추천 목록
     - GET /insights/opportunities: 기회 랭킹

  3. InsightService 클래스:
     - get_insights(
         insight_type: InsightType | None,
         min_confidence: float,
         limit: int
       ) -> list[InsightView]

     - get_insight_detail(insight_id: str) -> InsightDetail

     - get_recommendations(top_n: int) -> list[RecommendationView]

     - get_opportunity_ranking(limit: int) -> list[OpportunityView]
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.dashboard.routers.insights import router; print('Insights router OK')"
  </verify>
  <done>
  - 인사이트 라우터 구현
  </done>
</task>

<task type="auto">
  <name>Task 2: 뷰 데이터 구조</name>
  <files>src/reddit_insight/dashboard/services/insight_service.py</files>
  <action>
  services/insight_service.py 생성:

  1. InsightView 데이터 클래스:
     - id: str
     - insight_type: str
     - title: str
     - confidence: float
     - priority: float
     - evidence_count: int

  2. InsightDetail 데이터 클래스:
     - InsightView 확장
     - description: str
     - evidence: list[str]
     - related_entities: list[str]
     - related_demands: list[str]
     - created_at: datetime

  3. RecommendationView 데이터 클래스:
     - rank: int
     - insight_title: str
     - business_score: float
     - feasibility_score: float
     - final_score: float
     - grade: str
     - action_items: list[str]

  4. OpportunityView 데이터 클래스:
     - rank: int
     - insight_title: str
     - market_size_score: float
     - competition_score: float
     - urgency_score: float
     - total_score: float
     - grade: str
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.dashboard.services.insight_service import InsightService, InsightView; print('InsightService OK')"
  </verify>
  <done>
  - 인사이트 뷰 데이터 구조
  </done>
</task>

<task type="auto">
  <name>Task 3: 인사이트 템플릿</name>
  <files>src/reddit_insight/dashboard/templates/insights/</files>
  <action>
  templates/insights/ 디렉토리:

  1. insights/index.html:
     - 탭 네비게이션 (Insights / Recommendations / Opportunities)
     - 필터: 인사이트 유형, 신뢰도
     - 인사이트 카드 그리드

  2. insights/partials/insight_list.html:
     - 인사이트 카드 목록
     - 유형별 아이콘/색상
     - 신뢰도 바

  3. insights/partials/recommendation_list.html:
     - 추천 카드 (랭킹 표시)
     - 스코어 breakdown
     - 실행 항목 체크리스트

  4. insights/partials/opportunity_table.html:
     - 기회 랭킹 테이블
     - 차원별 점수 막대
     - 등급 배지 (A/B/C/D/F)

  5. insights/detail.html:
     - 인사이트 상세 페이지
     - 근거 목록
     - 관련 엔티티/수요 링크
  </action>
  <verify>
  - ls src/reddit_insight/dashboard/templates/insights/index.html
  </verify>
  <done>
  - 인사이트 템플릿 구현
  </done>
</task>

<task type="auto">
  <name>Task 4: 앱에 라우터 등록</name>
  <files>src/reddit_insight/dashboard/app.py</files>
  <action>
  1. app.py 업데이트:
     - from .routers import insights
     - app.include_router(insights.router)

  2. 네비게이션 업데이트:
     - base.html에 Insights 링크 (주요 메뉴로 강조)

  3. 홈 대시보드 업데이트:
     - 상위 추천 3개 표시
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.dashboard.app import app; print('App with insights OK')"
  </verify>
  <done>
  - 인사이트 라우터 등록
  </done>
</task>

</tasks>

<verification>
- [ ] /insights/ 페이지 동작
- [ ] 추천 목록 표시
- [ ] 기회 랭킹 표시
</verification>

<success_criteria>
- 모든 태스크 완료
- 인사이트 뷰 동작
</success_criteria>

<output>
After completion, create `.planning/phases/09-web-dashboard/09-04-SUMMARY.md`
</output>
