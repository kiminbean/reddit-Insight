# Plan 19-01: Integration Testing & Performance Optimization

## Objective

대시보드와 ML 모듈 통합을 E2E 테스트로 검증하고, 성능을 최적화하며, 문서를 업데이트한다.

## Execution Context

```
tests/
├── dashboard/
├── analysis/
└── e2e/                    # E2E 테스트 (신규)

docs/
├── README.md
└── dashboard.md            # 대시보드 문서 (신규)
```

## Context

### 테스트 대상

1. **데이터 흐름**: CLI 분석 → data_store → 대시보드 표시
2. **ML 통합**: TrendPredictor, AnomalyDetector, TopicModeler, TextClusterer
3. **API 엔드포인트**: 모든 dashboard 라우터

### 성능 최적화 대상

1. **캐싱**: ML 분석 결과 캐싱
2. **지연 로딩**: 대용량 데이터 페이지네이션
3. **비동기 처리**: 장시간 분석 백그라운드 실행

## Tasks

### Task 1: E2E 테스트 스위트 생성

**목표**: 주요 사용자 시나리오 테스트

**파일**: `tests/e2e/test_dashboard_flow.py`

**테스트 케이스**:
```python
class TestDashboardFlow:
    """대시보드 E2E 테스트."""

    async def test_full_analysis_flow(self):
        """분석 실행 → 대시보드 표시 전체 흐름."""
        # 1. 분석 실행 (mock 데이터)
        # 2. 대시보드 홈 접속
        # 3. Recent Analyses에 표시 확인
        # 4. 각 섹션 (Trends, Demands, Competition, Insights) 데이터 확인

    async def test_ml_prediction_flow(self):
        """ML 예측 흐름."""
        # 1. 키워드 선택
        # 2. 예측 API 호출
        # 3. 예측 결과 반환 확인

    async def test_topic_analysis_flow(self):
        """토픽 분석 흐름."""
        # 1. 토픽 분석 실행
        # 2. 토픽 결과 반환 확인

    async def test_cluster_analysis_flow(self):
        """클러스터링 흐름."""
        # 1. 클러스터링 실행
        # 2. 클러스터 결과 반환 확인
```

### Task 2: API 통합 테스트

**목표**: 모든 API 엔드포인트 테스트

**파일**: `tests/e2e/test_api_integration.py`

**테스트 케이스**:
- GET /dashboard (홈)
- GET /dashboard/trends
- GET /dashboard/trends/predict/{keyword}
- GET /dashboard/trends/anomalies/{keyword}
- GET /dashboard/demands
- GET /dashboard/competition
- GET /dashboard/insights
- GET /dashboard/topics
- GET /dashboard/topics/analyze
- GET /dashboard/clusters
- GET /dashboard/clusters/analyze

### Task 3: 성능 테스트 및 최적화

**목표**: 응답 시간 및 메모리 사용량 최적화

**파일**: `tests/performance/test_dashboard_perf.py`

**측정 항목**:
- 페이지 로드 시간 (< 500ms 목표)
- ML 분석 시간 (적절한 타임아웃 설정)
- 메모리 사용량 (피크 메모리 모니터링)

**최적화 작업**:
- ML 결과 캐싱 (LRU 캐시)
- 대용량 데이터 페이지네이션
- 불필요한 데이터 로드 제거

### Task 4: 에러 핸들링 테스트

**목표**: 에러 상황에서 graceful degradation

**파일**: `tests/e2e/test_error_handling.py`

**테스트 케이스**:
- 데이터 없을 때 빈 상태 표시
- ML 분석 실패 시 에러 메시지
- 잘못된 ID로 상세 페이지 접근 시 404

### Task 5: 문서 업데이트

**목표**: 대시보드 사용 가이드 작성

**파일**:
- `docs/dashboard.md`
- `README.md` 업데이트

**내용**:
- 대시보드 시작 방법
- 각 페이지 기능 설명
- ML 분석 기능 사용법
- API 엔드포인트 목록
- 트러블슈팅

### Task 6: 최종 품질 확인

**목표**: 릴리스 전 최종 검증

**체크리스트**:
- [ ] 모든 테스트 통과 (pytest)
- [ ] 타입 체크 통과 (mypy)
- [ ] 린트 통과 (ruff)
- [ ] 문서 완성도 확인
- [ ] 샘플 분석 실행 및 대시보드 확인

## Verification

```bash
# 1. 전체 테스트 실행
pytest tests/ -v --cov=reddit_insight

# 2. E2E 테스트만 실행
pytest tests/e2e/ -v

# 3. 성능 테스트 실행
pytest tests/performance/ -v

# 4. 타입 체크
mypy src/reddit_insight

# 5. 린트
ruff check src/

# 6. 커버리지 리포트
pytest --cov=reddit_insight --cov-report=html
```

## Success Criteria

- [ ] E2E 테스트 10개 이상 통과
- [ ] API 통합 테스트 전체 통과
- [ ] 페이지 로드 시간 < 500ms
- [ ] 테스트 커버리지 80% 이상
- [ ] 문서 완성 (dashboard.md)

## Output

- `tests/e2e/test_dashboard_flow.py` 생성
- `tests/e2e/test_api_integration.py` 생성
- `tests/e2e/test_error_handling.py` 생성
- `tests/performance/test_dashboard_perf.py` 생성
- `docs/dashboard.md` 생성
- `README.md` 업데이트
- 19-01-SUMMARY.md 작성
