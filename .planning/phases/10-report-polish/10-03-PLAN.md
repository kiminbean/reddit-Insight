---
phase: 10-report-polish
plan: 03
type: execute
depends_on: ["10-02"]
files_modified: [tests/test_integration.py, tests/test_e2e.py]
---

<objective>
엔드투엔드 테스트를 구현한다.

Purpose: 전체 파이프라인의 통합 테스트로 시스템 안정성 검증
Output: 통합 테스트, E2E 테스트, 테스트 픽스처
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md

**Test scope:**
- 데이터 수집 → 분석 → 인사이트 → 리포트 전체 흐름
- 각 모듈 통합 테스트
- 대시보드 라우트 테스트
</context>

<tasks>

<task type="auto">
  <name>Task 1: 테스트 픽스처</name>
  <files>tests/conftest.py, tests/fixtures/</files>
  <action>
  1. tests/conftest.py 업데이트:
     - 샘플 Post 데이터 픽스처
     - 샘플 Comment 데이터 픽스처
     - 분석 결과 픽스처

  2. tests/fixtures/ 디렉토리:
     - sample_posts.json: 테스트용 포스트 데이터
     - sample_comments.json: 테스트용 댓글 데이터
     - expected_trends.json: 예상 트렌드 결과
     - expected_demands.json: 예상 수요 결과

  3. 픽스처 로더:
     - load_fixture(name: str) -> dict
     - create_sample_posts(count: int) -> list[Post]
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'tests'); from conftest import *; print('Test fixtures OK')"
  </verify>
  <done>
  - 테스트 픽스처 설정
  </done>
</task>

<task type="auto">
  <name>Task 2: 통합 테스트</name>
  <files>tests/test_integration.py</files>
  <action>
  tests/test_integration.py 생성:

  1. TestAnalysisPipeline 클래스:
     - test_trend_analysis_pipeline():
       - 텍스트 → 키워드 추출 → 트렌드 분석

     - test_demand_discovery_pipeline():
       - 텍스트 → 패턴 탐지 → 수요 분류

     - test_competitive_analysis_pipeline():
       - 텍스트 → 엔티티 인식 → 감성 분석 → 불만 추출

  2. TestInsightGeneration 클래스:
     - test_rules_engine_generates_insights():
       - 분석 결과 → 인사이트 생성

     - test_opportunity_scoring():
       - 인사이트 → 스코어링 → 랭킹

     - test_feasibility_analysis():
       - 기회 → 실행 가능성 평가

  3. TestReportGeneration 클래스:
     - test_generate_trend_report():
     - test_generate_full_report():
     - test_export_reports():
  </action>
  <verify>
  - python -m pytest tests/test_integration.py -v --collect-only 2>/dev/null | head -30
  </verify>
  <done>
  - 통합 테스트 구현
  </done>
</task>

<task type="auto">
  <name>Task 3: E2E 테스트</name>
  <files>tests/test_e2e.py</files>
  <action>
  tests/test_e2e.py 생성:

  1. TestDashboardRoutes 클래스 (FastAPI TestClient):
     - test_home_page():
     - test_trends_page():
     - test_demands_page():
     - test_competition_page():
     - test_insights_page():
     - test_search_functionality():

  2. TestAPIEndpoints 클래스:
     - test_chart_data_endpoints():
     - test_htmx_partials():
     - test_filter_parameters():

  3. TestFullWorkflow 클래스:
     - test_complete_analysis_workflow():
       - 샘플 데이터 입력
       - 전체 분석 파이프라인 실행
       - 대시보드에서 결과 확인
       - 리포트 생성
  </action>
  <verify>
  - python -m pytest tests/test_e2e.py -v --collect-only 2>/dev/null | head -30
  </verify>
  <done>
  - E2E 테스트 구현
  </done>
</task>

<task type="auto">
  <name>Task 4: 테스트 실행 및 커버리지</name>
  <files>pyproject.toml</files>
  <action>
  1. pyproject.toml에 테스트 설정:
     - pytest 설정
     - coverage 설정
     - 테스트 마커 정의

  2. 테스트 실행:
     - 전체 테스트 스위트 실행
     - 실패 테스트 수정

  3. 테스트 문서화:
     - tests/README.md 생성
     - 테스트 실행 방법
     - 테스트 구조 설명
  </action>
  <verify>
  - python -m pytest tests/ -v --tb=short 2>&1 | tail -20
  </verify>
  <done>
  - 테스트 실행 완료
  </done>
</task>

</tasks>

<verification>
- [ ] 통합 테스트 통과
- [ ] E2E 테스트 통과
- [ ] 전체 테스트 실행 가능
</verification>

<success_criteria>
- 모든 태스크 완료
- 테스트 스위트 동작
</success_criteria>

<output>
After completion, create `.planning/phases/10-report-polish/10-03-SUMMARY.md`
</output>
