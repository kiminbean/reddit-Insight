---
phase: 10-report-polish
plan: 02
type: execute
depends_on: ["10-01"]
files_modified: [src/reddit_insight/reports/generator.py]
---

<objective>
리포트 생성 엔진을 구현한다.

Purpose: 템플릿과 데이터를 결합하여 완성된 마크다운 리포트 생성
Output: ReportGenerator, ReportConfig, 파일 내보내기
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-report-polish/10-01-PLAN.md

**Prior plan context:**
- TemplateRegistry로 템플릿 관리
- 마크다운 헬퍼 함수 구현됨

**Data sources:**
- TrendReport, DemandReport
- CompetitiveReport, InsightReport
</context>

<tasks>

<task type="auto">
  <name>Task 1: 리포트 생성기 구조</name>
  <files>src/reddit_insight/reports/generator.py</files>
  <action>
  generator.py 생성:

  1. ReportConfig 데이터 클래스:
     - title: str = "Reddit Insight Report"
     - author: str = "Reddit Insight"
     - include_toc: bool = True
     - include_summary: bool = True
     - include_metadata: bool = True
     - max_items_per_section: int = 10

  2. ReportGenerator 클래스:
     - __init__(
         template_registry: TemplateRegistry | None = None,
         config: ReportConfig | None = None
       )
     - _registry: TemplateRegistry
     - _config: ReportConfig
     - _env: jinja2.Environment

  3. 데이터 수집기:
     - ReportDataCollector 클래스:
       - trend_report: TrendReport | None
       - demand_report: DemandReport | None
       - competitive_report: CompetitiveReport | None
       - insight_report: InsightReport | None
       - metadata: dict[str, Any]
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.reports.generator import ReportGenerator, ReportConfig; print('ReportGenerator OK')"
  </verify>
  <done>
  - 리포트 생성기 구조 정의
  </done>
</task>

<task type="auto">
  <name>Task 2: 생성 메서드</name>
  <files>src/reddit_insight/reports/generator.py</files>
  <action>
  generator.py에 생성 메서드 추가:

  1. 개별 리포트 생성:
     - generate_trend_report(
         report: TrendReport,
         template_name: str | None = None
       ) -> str

     - generate_demand_report(
         report: DemandReport,
         template_name: str | None = None
       ) -> str

     - generate_competitive_report(
         report: CompetitiveReport,
         template_name: str | None = None
       ) -> str

     - generate_insight_report(
         report: InsightReport,
         template_name: str | None = None
       ) -> str

  2. 종합 리포트:
     - generate_full_report(
         data: ReportDataCollector
       ) -> str:
       - 목차 생성
       - 섹션별 렌더링
       - 메타데이터 추가

  3. 템플릿 렌더링:
     - _render(
         template: ReportTemplate,
         context: dict[str, Any]
       ) -> str
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.reports.generator import ReportGenerator; g = ReportGenerator(); print('Generation methods OK')"
  </verify>
  <done>
  - 리포트 생성 메서드 구현
  </done>
</task>

<task type="auto">
  <name>Task 3: 파일 내보내기</name>
  <files>src/reddit_insight/reports/generator.py</files>
  <action>
  generator.py에 내보내기 기능 추가:

  1. 파일 저장:
     - save_report(
         content: str,
         filepath: Path | str,
         create_dirs: bool = True
       ) -> Path

  2. 배치 내보내기:
     - export_all(
         data: ReportDataCollector,
         output_dir: Path | str
       ) -> list[Path]:
       - trend_report.md
       - demand_report.md
       - competitive_report.md
       - insight_report.md
       - full_report.md

  3. 메타데이터 파일:
     - _write_metadata(
         output_dir: Path,
         data: ReportDataCollector
       ) -> Path:
       - report_metadata.json 생성
       - 생성 시간, 분석 범위 등
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.reports.generator import ReportGenerator; g = ReportGenerator(); print('Export methods OK')"
  </verify>
  <done>
  - 파일 내보내기 구현
  </done>
</task>

<task type="auto">
  <name>Task 4: export 업데이트</name>
  <files>src/reddit_insight/reports/__init__.py</files>
  <action>
  __init__.py 업데이트:
  - ReportGenerator, ReportConfig export
  - ReportDataCollector export
  - __all__ 업데이트
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.reports import ReportGenerator, ReportConfig, ReportDataCollector; print('All generator exports OK')"
  </verify>
  <done>
  - 리포트 생성기 export
  </done>
</task>

</tasks>

<verification>
- [ ] 개별 리포트 생성 동작
- [ ] 종합 리포트 생성 동작
- [ ] 파일 내보내기 동작
</verification>

<success_criteria>
- 모든 태스크 완료
- 마크다운 리포트 생성 동작
</success_criteria>

<output>
After completion, create `.planning/phases/10-report-polish/10-02-SUMMARY.md`
</output>
