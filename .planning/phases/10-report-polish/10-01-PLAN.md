---
phase: 10-report-polish
plan: 01
type: execute
depends_on: ["09-05"]
files_modified: [src/reddit_insight/reports/templates.py]
---

<objective>
마크다운 리포트 템플릿 시스템을 구현한다.

Purpose: 분석 결과를 마크다운 형식으로 내보내기 위한 템플릿 정의
Output: ReportTemplate, TemplateRegistry, 기본 템플릿들
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md

**Prior context:**
- InsightReportGenerator가 이미 존재 (insights/feasibility.py)
- 분석 결과들: TrendReport, DemandReport, CompetitiveReport, InsightReport

**Template approach:**
- Jinja2 템플릿 기반
- 다양한 리포트 유형 지원
- 커스터마이징 가능
</context>

<tasks>

<task type="auto">
  <name>Task 1: 리포트 템플릿 구조</name>
  <files>src/reddit_insight/reports/__init__.py, src/reddit_insight/reports/templates.py</files>
  <action>
  src/reddit_insight/reports/ 패키지 생성:

  1. ReportType 열거형:
     - TREND: 트렌드 분석 리포트
     - DEMAND: 수요 분석 리포트
     - COMPETITIVE: 경쟁 분석 리포트
     - INSIGHT: 비즈니스 인사이트 리포트
     - FULL: 종합 리포트

  2. ReportTemplate 데이터 클래스:
     - name: str
     - report_type: ReportType
     - template_string: str
     - description: str
     - variables: list[str] (필수 변수 목록)

  3. TemplateRegistry 클래스:
     - _templates: dict[str, ReportTemplate]
     - register(template: ReportTemplate)
     - get(name: str) -> ReportTemplate
     - list_templates() -> list[ReportTemplate]
     - load_defaults()
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.reports import ReportType, ReportTemplate, TemplateRegistry; print('Report templates OK')"
  </verify>
  <done>
  - 리포트 템플릿 구조 정의
  </done>
</task>

<task type="auto">
  <name>Task 2: 기본 템플릿 정의</name>
  <files>src/reddit_insight/reports/templates.py</files>
  <action>
  templates.py에 기본 템플릿 추가:

  1. TREND_REPORT_TEMPLATE:
     - 제목, 요약
     - 상위 키워드 테이블
     - Rising 키워드 섹션
     - 트렌드 변화 요약

  2. DEMAND_REPORT_TEMPLATE:
     - 수요 요약 통계
     - 카테고리별 분포
     - 상위 수요 목록
     - 우선순위 분석

  3. COMPETITIVE_REPORT_TEMPLATE:
     - 엔티티 개요
     - 감성 분석 요약
     - 주요 불만 목록
     - 대안/전환 패턴

  4. INSIGHT_REPORT_TEMPLATE:
     - 인사이트 요약
     - 기회 랭킹
     - 추천 액션
     - 실행 가능성 분석

  5. FULL_REPORT_TEMPLATE:
     - 종합 요약
     - 각 섹션 통합
     - 결론 및 권장사항
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.reports.templates import TemplateRegistry; r = TemplateRegistry(); r.load_defaults(); print(f'Loaded {len(r.list_templates())} templates')"
  </verify>
  <done>
  - 5가지 기본 템플릿 정의
  </done>
</task>

<task type="auto">
  <name>Task 3: 템플릿 헬퍼</name>
  <files>src/reddit_insight/reports/templates.py</files>
  <action>
  templates.py에 헬퍼 함수 추가:

  1. 마크다운 유틸리티:
     - format_table(headers: list[str], rows: list[list[str]]) -> str
     - format_list(items: list[str], ordered: bool = False) -> str
     - format_badge(text: str, color: str) -> str

  2. 데이터 포맷터:
     - format_percentage(value: float, decimals: int = 1) -> str
     - format_score(value: float, max_value: float = 100) -> str
     - format_date(dt: datetime) -> str
     - format_trend(direction: str) -> str (↑/↓/→)

  3. 차트 텍스트 표현:
     - text_bar(value: float, width: int = 20) -> str
     - text_sparkline(values: list[float]) -> str
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.reports.templates import format_table, format_percentage, text_bar; print(text_bar(75))"
  </verify>
  <done>
  - 마크다운 헬퍼 구현
  </done>
</task>

<task type="auto">
  <name>Task 4: export 설정</name>
  <files>src/reddit_insight/reports/__init__.py</files>
  <action>
  __init__.py 업데이트:
  - ReportType, ReportTemplate export
  - TemplateRegistry export
  - 헬퍼 함수 export
  - __all__ 정의
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.reports import ReportType, TemplateRegistry, format_table; print('All report exports OK')"
  </verify>
  <done>
  - 리포트 템플릿 모듈 export
  </done>
</task>

</tasks>

<verification>
- [ ] 5가지 ReportType 정의됨
- [ ] 기본 템플릿 로드됨
- [ ] 헬퍼 함수 동작
</verification>

<success_criteria>
- 모든 태스크 완료
- 리포트 템플릿 시스템 동작
</success_criteria>

<output>
After completion, create `.planning/phases/10-report-polish/10-01-SUMMARY.md`
</output>
