---
phase: 02-reddit-api
plan: 03
type: execute
depends_on: ["02-01"]
files_modified: [src/reddit_insight/reddit/subreddits.py, src/reddit_insight/reddit/client.py, src/reddit_insight/reddit/__init__.py]
---

<objective>
Subreddit 탐색 및 메타데이터 수집 기능을 구현한다.

Purpose: 관심 있는 서브레딧을 발견하고 메타데이터를 수집
Output: SubredditExplorer 클래스, 서브레딧 검색/추천/메타데이터 기능
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-reddit-api/02-01-PLAN.md

**Prior plan context:**
- RedditClient 클래스 구현됨
- SubredditInfo Pydantic 모델 정의됨
- PRAW 의존성 추가됨

**Use case:**
- 관심사 키워드로 관련 서브레딧 탐색
- 서브레딧 크기/활성도 메타데이터 수집
- 비즈니스 인사이트를 위한 서브레딧 분류
</context>

<tasks>

<task type="auto">
  <name>Task 1: SubredditExplorer 기본 구현</name>
  <files>src/reddit_insight/reddit/subreddits.py</files>
  <action>
  src/reddit_insight/reddit/subreddits.py 생성:

  1. SubredditExplorer 클래스:
     - __init__(client: RedditClient)

  2. 검색 메서드:
     - search(query: str, limit: int = 25) -> list[SubredditInfo]
       - 키워드로 서브레딧 검색
     - search_by_name(query: str, include_nsfw: bool = False) -> list[SubredditInfo]
       - 이름으로 서브레딧 검색 (자동완성 스타일)

  3. 정보 조회:
     - get_info(name: str) -> SubredditInfo | None
       - 단일 서브레딧 상세 정보
     - get_info_batch(names: list[str]) -> list[SubredditInfo]
       - 여러 서브레딧 일괄 조회

  4. 유틸리티:
     - _convert_subreddit(subreddit) -> SubredditInfo
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.reddit.subreddits import SubredditExplorer; print('SubredditExplorer OK')"
  </verify>
  <done>
  - SubredditExplorer가 검색 및 정보 조회 지원
  - SubredditInfo 모델로 변환됨
  </done>
</task>

<task type="auto">
  <name>Task 2: 인기/추천 서브레딧 탐색</name>
  <files>src/reddit_insight/reddit/subreddits.py</files>
  <action>
  SubredditExplorer에 메서드 추가:

  1. 인기 서브레딧:
     - get_popular(limit: int = 25) -> list[SubredditInfo]
       - Reddit 전체에서 인기 서브레딧
     - get_new(limit: int = 25) -> list[SubredditInfo]
       - 최근 생성된 서브레딧

  2. 기본 서브레딧:
     - get_default() -> list[SubredditInfo]
       - Reddit 기본 구독 서브레딧 목록

  3. 관련 서브레딧 (있는 경우):
     - get_related(subreddit: str) -> list[str]
       - 서브레딧 사이드바에서 관련 서브레딧 추출
       - 없으면 빈 리스트 반환
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.reddit.subreddits import SubredditExplorer; print('Extended methods OK')"
  </verify>
  <done>
  - 인기/신규/기본 서브레딧 목록 조회 가능
  - 관련 서브레딧 탐색 지원
  </done>
</task>

<task type="auto">
  <name>Task 3: 서브레딧 활성도 메트릭</name>
  <files>src/reddit_insight/reddit/subreddits.py, src/reddit_insight/reddit/models.py</files>
  <action>
  1. models.py에 SubredditMetrics 모델 추가:
     - name: str
     - subscribers: int
     - active_users: int | None (accounts_active)
     - posts_per_day: float | None (계산값)
     - comments_per_day: float | None (계산값)
     - avg_score: float | None
     - growth_rate: float | None (가능한 경우)

  2. SubredditExplorer에 메서드 추가:
     - get_metrics(name: str, sample_posts: int = 100) -> SubredditMetrics
       - 최근 게시물 샘플링으로 활성도 계산
     - compare_subreddits(names: list[str]) -> list[SubredditMetrics]
       - 여러 서브레딧 메트릭 비교

  주의:
  - active_users는 서브레딧 페이지에서만 접근 가능
  - posts_per_day는 최근 게시물 타임스탬프로 추정
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.reddit.models import SubredditMetrics; print('SubredditMetrics OK')"
  </verify>
  <done>
  - 서브레딧 활성도 메트릭 계산 가능
  - 여러 서브레딧 비교 지원
  </done>
</task>

<task type="auto">
  <name>Task 4: RedditClient 통합 및 export</name>
  <files>src/reddit_insight/reddit/client.py, src/reddit_insight/reddit/__init__.py</files>
  <action>
  1. client.py의 RedditClient 확장:
     - subreddits 프로퍼티: SubredditExplorer 인스턴스 반환 (lazy init)

  2. 편의 메서드 추가:
     - search_subreddits(query: str, limit: int = 25) -> list[SubredditInfo]
     - get_subreddit_info(name: str) -> SubredditInfo | None

  3. __init__.py 업데이트:
     - SubredditExplorer, SubredditMetrics export 추가
     - __all__ 업데이트
  </action>
  <verify>
  - python -c "import sys; sys.path.insert(0, 'src'); from reddit_insight.reddit import RedditClient, SubredditExplorer, SubredditInfo, SubredditMetrics; print('All Phase 2 exports OK')"
  </verify>
  <done>
  - RedditClient.subreddits로 탐색기 접근 가능
  - 모든 Phase 2 모듈이 export됨
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] 서브레딧 검색 (키워드, 이름) 동작
- [ ] 인기/신규/기본 서브레딧 조회 가능
- [ ] SubredditMetrics로 활성도 분석 가능
- [ ] RedditClient에서 모든 기능 접근 가능
</verification>

<success_criteria>

- 모든 태스크 완료
- 서브레딧 탐색 및 메타데이터 수집 기능 완성
- 비즈니스 인사이트를 위한 메트릭 계산 가능

</success_criteria>

<output>
After completion, create `.planning/phases/02-reddit-api/02-03-SUMMARY.md`
</output>
