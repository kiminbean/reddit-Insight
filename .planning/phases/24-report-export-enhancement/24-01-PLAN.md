---
phase: 24-report-export-enhancement
plan: 01
type: execute
depends_on: ["23-01"]
files_modified: [src/reddit_insight/reports/pdf_generator.py, src/reddit_insight/reports/excel_generator.py, src/reddit_insight/dashboard/routers/reports.py]
---

<objective>
리포트 내보내기 기능을 확장한다: PDF 및 Excel 내보내기 추가.

Purpose: 다양한 형식의 리포트 제공으로 비즈니스 활용도 향상
Output: PDFGenerator, ExcelGenerator, 새 리포트 템플릿
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/reddit_insight/reports/generator.py
@src/reddit_insight/reports/templates/

**현재 리포트 기능:**
- 마크다운 리포트 생성 (Jinja2 템플릿)
- ReportGenerator 클래스

**확장 대상:**
- PDF 내보내기 (weasyprint 또는 reportlab)
- Excel 내보내기 (openpyxl)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement PDF Report Generator</name>
  <files>src/reddit_insight/reports/pdf_generator.py, pyproject.toml</files>
  <action>PDF 리포트 생성기를 구현한다:

  1. 의존성 추가: weasyprint (HTML to PDF)
  2. PDFGenerator 클래스:
     ```python
     class PDFGenerator:
         def generate(self, analysis_data: AnalysisData) -> bytes:
             """분석 데이터를 PDF로 변환"""
         def generate_from_html(self, html: str) -> bytes:
             """HTML을 PDF로 변환"""
     ```
  3. PDF 템플릿 (HTML 기반):
     - 헤더: 로고, 제목, 날짜
     - 요약 섹션: 핵심 지표
     - 트렌드 섹션: 키워드 테이블, 차트 이미지
     - 인사이트 섹션: 비즈니스 기회
     - 푸터: 페이지 번호

  weasyprint 사용 이유: HTML/CSS 기반으로 스타일링 용이, 기존 템플릿 재사용 가능</action>
  <verify>pytest tests/reports/test_pdf_generator.py -v</verify>
  <done>PDFGenerator 구현 완료, PDF 생성 테스트 통과</done>
</task>

<task type="auto">
  <name>Task 2: Implement Excel Report Generator</name>
  <files>src/reddit_insight/reports/excel_generator.py, pyproject.toml</files>
  <action>Excel 리포트 생성기를 구현한다:

  1. 의존성 추가: openpyxl
  2. ExcelGenerator 클래스:
     ```python
     class ExcelGenerator:
         def generate(self, analysis_data: AnalysisData) -> bytes:
             """분석 데이터를 Excel로 변환"""
     ```
  3. Excel 구조:
     - Sheet 1: 요약 (Summary)
     - Sheet 2: 키워드 (Keywords) - 정렬 가능한 테이블
     - Sheet 3: 트렌드 (Trends) - 시계열 데이터
     - Sheet 4: 인사이트 (Insights) - 비즈니스 기회
     - Sheet 5: 수요 (Demands) - 수요 패턴
  4. 스타일링:
     - 헤더 행 볼드 및 배경색
     - 숫자 포맷팅
     - 열 너비 자동 조정</action>
  <verify>pytest tests/reports/test_excel_generator.py -v</verify>
  <done>ExcelGenerator 구현 완료, Excel 생성 테스트 통과</done>
</task>

<task type="auto">
  <name>Task 3: Add Export Endpoints to Dashboard</name>
  <files>src/reddit_insight/dashboard/routers/reports.py, src/reddit_insight/dashboard/templates/reports/index.html</files>
  <action>대시보드에 PDF/Excel 내보내기 엔드포인트를 추가한다:

  1. 새 엔드포인트:
     - GET /dashboard/reports/download/pdf - PDF 다운로드
     - GET /dashboard/reports/download/excel - Excel 다운로드

  2. 리포트 페이지 UI 업데이트:
     - 포맷 선택 드롭다운 (Markdown, PDF, Excel)
     - 다운로드 버튼

  3. 응답 헤더:
     - Content-Type: application/pdf, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
     - Content-Disposition: attachment; filename="report_{date}.{ext}"</action>
  <verify>curl로 PDF/Excel 다운로드 확인, 파일 유효성 검사</verify>
  <done>PDF/Excel 다운로드 엔드포인트 구현 완료</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] PDF 생성 및 다운로드 작동
- [ ] Excel 생성 및 다운로드 작동
- [ ] 생성된 파일 열기 가능 (Adobe Reader, Excel)
- [ ] 기존 마크다운 리포트 기능 유지
</verification>

<success_criteria>

- PDFGenerator, ExcelGenerator 구현
- 대시보드에서 3가지 형식 다운로드 가능
- 단위 테스트 통과
</success_criteria>

<output>
After completion, create `.planning/phases/24-report-export-enhancement/24-01-SUMMARY.md`
</output>
