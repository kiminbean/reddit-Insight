<!-- Topic Cards Partial -->
<!-- Used by HTMX to dynamically load topic keyword cards -->

{% set card_colors = [
    {'bg': 'bg-blue-50', 'border': 'border-blue-200', 'text': 'text-blue-800', 'badge': 'bg-blue-100 text-blue-700'},
    {'bg': 'bg-red-50', 'border': 'border-red-200', 'text': 'text-red-800', 'badge': 'bg-red-100 text-red-700'},
    {'bg': 'bg-green-50', 'border': 'border-green-200', 'text': 'text-green-800', 'badge': 'bg-green-100 text-green-700'},
    {'bg': 'bg-purple-50', 'border': 'border-purple-200', 'text': 'text-purple-800', 'badge': 'bg-purple-100 text-purple-700'},
    {'bg': 'bg-orange-50', 'border': 'border-orange-200', 'text': 'text-orange-800', 'badge': 'bg-orange-100 text-orange-700'},
    {'bg': 'bg-teal-50', 'border': 'border-teal-200', 'text': 'text-teal-800', 'badge': 'bg-teal-100 text-teal-700'},
    {'bg': 'bg-pink-50', 'border': 'border-pink-200', 'text': 'text-pink-800', 'badge': 'bg-pink-100 text-pink-700'},
    {'bg': 'bg-yellow-50', 'border': 'border-yellow-200', 'text': 'text-yellow-800', 'badge': 'bg-yellow-100 text-yellow-700'},
    {'bg': 'bg-indigo-50', 'border': 'border-indigo-200', 'text': 'text-indigo-800', 'badge': 'bg-indigo-100 text-indigo-700'},
    {'bg': 'bg-gray-50', 'border': 'border-gray-200', 'text': 'text-gray-800', 'badge': 'bg-gray-100 text-gray-700'}
] %}

{% if topics %}
    <!-- Summary Info -->
    <div class="mb-4 text-sm text-gray-600">
        <span class="font-medium">{{ topics|length }}</span> topics extracted using
        <span class="font-medium uppercase">{{ method }}</span> method.
        Overall coherence: <span class="font-medium">{{ "%.3f"|format(overall_coherence) }}</span>.
        <span class="font-medium">{{ document_count }}</span> documents analyzed.
    </div>

    <!-- Topic Cards Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {% for topic in topics %}
            {% set colors = card_colors[loop.index0 % card_colors|length] %}
            <div class="rounded-lg border {{ colors.border }} {{ colors.bg }} p-4">
                <div class="flex items-center justify-between mb-3">
                    <h4 class="font-medium {{ colors.text }}">Topic {{ topic.id }}</h4>
                    {% if topic.coherence is not none %}
                        <span class="text-xs {{ colors.text }} opacity-70">
                            Coherence: {{ "%.3f"|format(topic.coherence) }}
                        </span>
                    {% endif %}
                </div>

                <p class="text-sm {{ colors.text }} font-medium mb-2 truncate" title="{{ topic.label }}">
                    {{ topic.label }}
                </p>

                <div class="flex flex-wrap gap-1">
                    {% for kw in topic.keywords[:10] %}
                        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium {{ colors.badge }}">
                            {{ kw.word }}
                            <span class="ml-1 text-xs opacity-60">{{ kw.weight_percent|int }}%</span>
                        </span>
                    {% endfor %}
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="text-center py-8 text-gray-500">
        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <p class="mt-2">No topics to display</p>
        <p class="text-sm">Run an analysis to see topic keywords here.</p>
    </div>
{% endif %}
