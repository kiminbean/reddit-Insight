<!-- Cluster Cards Partial -->
<!-- Used for HTMX partial updates -->

{% set cardColors = [
    { 'bg': 'bg-blue-50', 'border': 'border-blue-200', 'text': 'text-blue-800', 'badge': 'bg-blue-100 text-blue-700' },
    { 'bg': 'bg-red-50', 'border': 'border-red-200', 'text': 'text-red-800', 'badge': 'bg-red-100 text-red-700' },
    { 'bg': 'bg-green-50', 'border': 'border-green-200', 'text': 'text-green-800', 'badge': 'bg-green-100 text-green-700' },
    { 'bg': 'bg-purple-50', 'border': 'border-purple-200', 'text': 'text-purple-800', 'badge': 'bg-purple-100 text-purple-700' },
    { 'bg': 'bg-orange-50', 'border': 'border-orange-200', 'text': 'text-orange-800', 'badge': 'bg-orange-100 text-orange-700' },
    { 'bg': 'bg-teal-50', 'border': 'border-teal-200', 'text': 'text-teal-800', 'badge': 'bg-teal-100 text-teal-700' },
    { 'bg': 'bg-pink-50', 'border': 'border-pink-200', 'text': 'text-pink-800', 'badge': 'bg-pink-100 text-pink-700' },
    { 'bg': 'bg-yellow-50', 'border': 'border-yellow-200', 'text': 'text-yellow-800', 'badge': 'bg-yellow-100 text-yellow-700' },
    { 'bg': 'bg-indigo-50', 'border': 'border-indigo-200', 'text': 'text-indigo-800', 'badge': 'bg-indigo-100 text-indigo-700' },
    { 'bg': 'bg-gray-50', 'border': 'border-gray-200', 'text': 'text-gray-800', 'badge': 'bg-gray-100 text-gray-700' }
] %}

<!-- Summary Info -->
<div class="mb-4 flex flex-wrap items-center gap-4 text-sm text-gray-600">
    <span>
        <span class="font-medium">{{ clusters|length }}</span> clusters found
    </span>
    <span>
        Method: <span class="font-medium">{{ method|upper }}</span>
    </span>
    <span>
        Silhouette Score: <span class="font-medium">{{ "%.3f"|format(silhouette_score) }}</span>
    </span>
    <span>
        <span class="font-medium">{{ document_count }}</span> documents analyzed
    </span>
</div>

<!-- Cluster Cards Grid -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
    {% for cluster in clusters %}
    {% set colors = cardColors[loop.index0 % cardColors|length] %}
    <a href="/dashboard/clusters/cluster/{{ cluster.id }}" class="block">
        <div class="rounded-lg border {{ colors.border }} {{ colors.bg }} p-4 hover:shadow-md transition-shadow cursor-pointer">
            <div class="flex items-center justify-between mb-3">
                <h4 class="font-medium {{ colors.text }}">Cluster {{ cluster.id }}</h4>
                <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-white/50 {{ colors.text }}">
                    {{ cluster.size }} docs ({{ "%.1f"|format(cluster.percentage) }}%)
                </span>
            </div>
            <p class="text-sm {{ colors.text }} font-medium mb-2 truncate" title="{{ cluster.label }}">
                {{ cluster.label }}
            </p>
            <div class="flex flex-wrap gap-1 mb-3">
                {% for kw in cluster.keywords %}
                <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium {{ colors.badge }}">
                    {{ kw.word }}
                </span>
                {% endfor %}
            </div>
            {% if cluster.sample_docs %}
            <div class="mt-3 pt-3 border-t border-opacity-30 {{ colors.border }}">
                <p class="text-xs font-medium {{ colors.text }} mb-1">Sample Documents:</p>
                <div class="space-y-1">
                    {% for doc in cluster.sample_docs[:3] %}
                    <div class="text-xs text-gray-600 truncate" title="{{ doc }}">
                        {{ doc }}
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
            <div class="mt-3 text-xs {{ colors.text }} opacity-70 text-right">
                Click to view all documents
            </div>
        </div>
    </a>
    {% endfor %}
</div>

{% if not clusters %}
<div class="text-center py-8 text-gray-500">
    No clusters available. Run the clustering analysis to see results.
</div>
{% endif %}
